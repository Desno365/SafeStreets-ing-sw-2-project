<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>SafeStreets Municipality Interface</title>
	<link href="stylesheets/TemplateStylesheet.css" media="screen" rel="stylesheet" type="text/css"/>
</head>
<body>

<script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-firestore.js"></script>
<script src="scripts/api.js"></script>

<style>

	o_b {
		display: inline-block;
		height: 50%;
		margin-left: 15%;
		padding-top: 20px;
		background-color: lightgrey;
	}

	h1 {
		display: block;
		font-size: xx-large;
		padding-left: 50%;
		height: auto;
	}


	report {
		display: block;
		margin-left: 10%;
		padding-left: 5px;
		list-style-type: none;
		background-color: white;
		font-size: large;
		border-bottom: 1px solid black;
		border-top: 1px solid black;
	}

	report li {
		padding: 5px;
	}

	button {
		display: inline-block;
		margin-left: 10%;
		padding: 2%;
		text-align: center;
	}

</style>

<div class="center">SafeStreets Municipality Interface</div>


<ul class="hamburger-menu">
	<li class="active"><a href="AcceptViolations.html">Accept Violations</a></li>
	<li><a href="DisplayData.html">Display Data</a></li>
	<li><a href="ShowStatistics.html">Show Statistics</a></li>
	<lg id="logout">Logout</lg>
</ul>

<o_b>
	Order by
	<menu style="display: inline">number of reports</menu>
</o_b>

<h1>
	Violations
</h1>

<button onclick="createReport()">Create report</button>
<button onclick="retrieveReports()">Retrieve reports</button>

<script>
    let counter = 0;

    function createReport() {
        createReportWithParameters(counter++, counter++, counter++, counter++)

    }

    function createReportWithParameters(licensePlate, location, violationType, numOfReports) {
        console.log(firebase.auth().currentUser);

        let newReportElem = document.createElement('report');
        let licenseElem = document.createElement('li');
        let locationElem = document.createElement('li');
        let violationTypeElem = document.createElement('li');
        let numOfReportsElem = document.createElement('li');

        licenseElem.textContent = "License plate: " + licensePlate;
        locationElem.textContent = "Location: " + location;
        violationTypeElem.textContent = "Violation type: " + violationType;
        numOfReportsElem.textContent = "Number of reports: " + numOfReports;

        newReportElem.appendChild(licenseElem);
        newReportElem.appendChild(locationElem);
        newReportElem.appendChild(violationTypeElem);
        newReportElem.appendChild(numOfReportsElem);

        document.body.appendChild(newReportElem);
    }
</script>

<report>
	<li>License plate: XXX</li>
	<li>Location: ZZZ</li>
	<li>Violation type: CCC</li>
	<li>Number of reports: 99</li>
</report>

<!-- RETRIEVE REPORT SCRIPT -->
<script>
    function retrieveReports() {
        var reports = firebase.firestore().collection("violationReports");
        reports.get().then(function (querySnapshot) {
            querySnapshot.forEach(function (doc) {
                console.log(doc.data());
                let licensePlate = doc.get("licensePlate");
                let location = doc.get("latitude").toString() + "  |  " + doc.get("longitude").toString();
                let violationType = doc.get("violationType");
                let numOfReports = "Not implemented yet";

                createReportWithParameters(licensePlate, location, violationType, numOfReports);
            })
        })

    }

</script>


<script src="scripts/logout.js"></script>

</body>
</html>